\usepackage{emptypage}
\usepackage{ulem}
\usepackage[utf8]{inputenc}
\usepackage{ctex}
\usepackage{indentfirst}
\usepackage{hyperref}
\usepackage{color}

\newcommand{\blankpage}{
  \newpage
  \makebox{}
  \vfill
  \thispagestyle{empty}}
\raggedbottom

\usepackage{titletoc}

\newcommand{\mytitle}{死亡也不能将我们分开}

\usepackage{geometry}
\geometry{
  paperwidth=154mm,
  paperheight=216mm,
  total={120mm,175mm},
  left=17mm,
  top=23mm,
}

\hypersetup{hidelinks}

\renewcommand{\contentsname}{\youyuan \vspace{-4em} \hfill 目\hspace{1em}录 \hfill}

\usepackage{framed}

\renewenvironment{leftbar}{
  \def\FrameCommand{
    \hspace{0.5em}{\color{black}\vrule width 1.5pt depth 5pt}\hspace{1em}}%
  \MakeFramed{\parshape 1 0cm \dimexpr\textwidth-6em\relax\FrameRestore}%
}{\endMakeFramed}

\usepackage{titletoc}

\setcounter{tocdepth}{1}
\counterwithout{section}{chapter}
\counterwithout{subsection}{section}

\titlecontents{chapter}
[0em]
{\Large\bfseries\sffamily}
{\vspace{0.5em}\hspace{-4em}\parbox{6.5em}{\vspace{0.5em}\hfill\Large\bfseries\color{black}\thecontentspage}\vspace*{-1.9\baselineskip}\leftbar\lishu\bfseries}
{}{\endleftbar}

\titlecontents{section}
[6em]
{\rmfamily\color{black}}
{\S \hspace{0.5em}\thecontentslabel\hspace{1em}}{}
{\phantom{    }\dotfill \nobreak\itshape\contentspage}

\usepackage{titlesec}

\titleformat{\chapter}{\huge\bfseries\yahei}{\thispagestyle{empty}}{1em}{}

\titleformat{\section}{\bfseries\sffamily}{Chapter~\thesection}{1em}{}

\titleformat{\subsection}{\sffamily}{0\thesubsection}{1em}{}

\titlespacing*{\chapter}{1em}{5em}{1em}
\titlespacing*{\section}{2em}{2em}{1em}
\titlespacing*{\subsection}{2em}{1em}{1em}

\usepackage{fancyhdr}
\renewcommand{\chaptermark}[1]{\markboth{\MakeUppercase{#1}}{}}
\renewcommand{\headrulewidth}{0pt}
\fancypagestyle{mystyle}{
  \fancyhf{}
  \fancyhead[LE,RO]{\ttfamily\thepage}
  \fancyhead[CE]{\ttfamily\mytitle}
  \fancyhead[CO]{\ttfamily\leftmark}
}

\newcommand{\storyend}[1][完]{
  \vspace{2em}
  \hfill #1 \hspace{5em}
  % \vspace{2em}
}

\newcommand{\horline}{
  % \vspace{-1em}
  \begin{center}
    \rule{0.8\linewidth}{0.5pt}
  \end{center}
  \vspace{0.5em}
}

\usepackage{etoolbox}
\AtBeginEnvironment{quote}{\itshape}

\usepackage{multicol}
\setlength{\columnsep}{2em}

\newcommand{\parttitle}[1]{
  \vspace{2em}
  \textit{#1}
  \vspace{1em}
}

\usepackage{tcolorbox}

\newcommand{\onepage}[2]{
  \vspace{2em}
  \begin{tcolorbox}[title ={\textit{#1}} , colback = white, colframe = gray, boxrule = 0.5pt, lefttitle = 5em, toptitle = 0.1em, bottomtitle = 0.1em, before upper = {\parindent2em}]
    \begin{small}
      \begin{multicols}{2}
        \input{Short/#2}
      \end{multicols}
    \end{small}
  \end{tcolorbox}
}

\newcommand{\tag}[1]{
  \begin{footnotesize}
    \parindent0pt \textcolor{gray}{\# #1}
  \end{footnotesize}
}
